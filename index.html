<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Visor de ImÃ¡genes Firebase</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body{font-family:sans-serif;margin:20px;background:#f5f5f5}
    h1{text-align:center}
    form{display:flex;gap:8px;margin:20px auto;max-width:500px}
    input,button{padding:10px;border-radius:6px;border:1px solid #ccc}
    button{cursor:pointer;background:#007bff;color:white;border:none}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;margin-top:20px}
    .card{background:white;padding:10px;border-radius:10px;box-shadow:0 2px 5px rgba(0,0,0,.1);text-align:center}
    .card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
    .title{margin-top:6px;font-size:14px;color:#333}
  </style>
</head>
<body>
  <h1>ðŸ“· GalerÃ­a Firebase</h1>

  <form id="form-gallery">
    <input id="input-url" type="url" placeholder="URL de la imagen" required style="flex:2">
    <input id="input-title" type="text" placeholder="TÃ­tulo" required style="flex:1">
    <button type="submit">Agregar</button>
  </form>

  <div class="grid" id="gallery"></div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

    // TU CONFIG (copiar de Firebase Console)
    const firebaseConfig = {
      apiKey: "TU_API_KEY",
      authDomain: "TU_AUTH_DOMAIN",
      projectId: "TU_PROJECT_ID",
      storageBucket: "TU_STORAGE_BUCKET",
      messagingSenderId: "TU_SENDER_ID",
      appId: "TU_APP_ID"
    };

    // Inicializar
    const app = initializeApp(firebaseConfig);
    const db  = getFirestore(app);

    const galleryRef = collection(db, "gallery");
    const q = query(galleryRef, orderBy("createdAt", "desc"));

    const galleryDiv = document.getElementById("gallery");

    // Render en tiempo real
    onSnapshot(q, snap => {
      galleryDiv.innerHTML = "";
      snap.forEach(doc => {
        const data = doc.data();
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${data.url}" alt="${data.titulo}">
          <div class="title">${data.titulo}</div>
        `;
        galleryDiv.appendChild(card);
      });
    });

    // Agregar imagen
    document.getElementById("form-gallery").addEventListener("submit", async e => {
      e.preventDefault();
      const url   = document.getElementById("input-url").value.trim();
      const title = document.getElementById("input-title").value.trim();
      if(!url || !title) return;

      await addDoc(galleryRef, {
        url: url,
        titulo: title,
        createdAt: serverTimestamp()
      });

      e.target.reset();
    });
  </script>
</body>
</html>
